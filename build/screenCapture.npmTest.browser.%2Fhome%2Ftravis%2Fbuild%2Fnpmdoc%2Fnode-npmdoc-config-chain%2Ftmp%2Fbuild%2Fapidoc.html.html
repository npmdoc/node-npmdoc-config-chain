<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="http://github.com/dominictarr/config-chain">config-chain (v1.1.11)</a>
</h1>
<h4>HANDLE CONFIGURATION ONCE AND FOR ALL</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.config-chain">module config-chain</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain">
            function <span class="apidocSignatureSpan">config-chain.</span>ConfigChain
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.env">
            function <span class="apidocSignatureSpan">config-chain.</span>env
            <span class="apidocSignatureSpan">(prefix, env)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.find">
            function <span class="apidocSignatureSpan">config-chain.</span>find
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.json">
            function <span class="apidocSignatureSpan">config-chain.</span>json
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.parse">
            function <span class="apidocSignatureSpan">config-chain.</span>parse
            <span class="apidocSignatureSpan">(content, file, type)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">config-chain.</span>ConfigChain.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.config-chain.ConfigChain">module config-chain.ConfigChain</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.ConfigChain">
            function <span class="apidocSignatureSpan">config-chain.</span>ConfigChain
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.config-chain.ConfigChain.prototype">module config-chain.ConfigChain.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype._await">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>_await
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype._resolve">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>_resolve
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.add">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>add
            <span class="apidocSignatureSpan">(data, marker)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.addEnv">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addEnv
            <span class="apidocSignatureSpan">(prefix, env, name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.addFile">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addFile
            <span class="apidocSignatureSpan">(file, type, name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.addListener">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addListener
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.addString">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addString
            <span class="apidocSignatureSpan">(data, file, type, marker)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.addUrl">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addUrl
            <span class="apidocSignatureSpan">(req, type, name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.del">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>del
            <span class="apidocSignatureSpan">(key, where)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.emit">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>emit
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.eventNames">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>eventNames
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.get">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>get
            <span class="apidocSignatureSpan">(key, where)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.getMaxListeners">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>getMaxListeners
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.listenerCount">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>listenerCount
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.listeners">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>listeners
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.on">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>on
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.once">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>once
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.parse">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>parse
            <span class="apidocSignatureSpan">(content, file, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.prependListener">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>prependListener
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.prependOnceListener">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>prependOnceListener
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.removeAllListeners">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>removeAllListeners
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.removeListener">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>removeListener
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.save">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>save
            <span class="apidocSignatureSpan">(where, type, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.set">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>set
            <span class="apidocSignatureSpan">(key, value, where)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.config-chain.ConfigChain.prototype.setMaxListeners">
            function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>setMaxListeners
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">undefined <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>domain</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.config-chain" id="apidoc.module.config-chain">module config-chain</a></h1>


    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain" id="apidoc.element.config-chain.ConfigChain">
        function <span class="apidocSignatureSpan">config-chain.</span>ConfigChain
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ConfigChain() {
  EE.apply(this)
  ProtoList.apply(this, arguments)
  this._awaiting = 0
  this._saving = 0
  this.sources = {}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Get all the keys on the provided env object (or process.env) which are
prefixed by the specified prefix, and put the values on a new object.

RETURN THE RESULTING OBJECT!

NO I/O!

## cc.<span class="apidocCodeKeywordSpan">ConfigChain</span>()

The ConfigChain class for CRAY CRAY JQUERY STYLE METHOD CHAINING!

One of these is returned by the main exported function, as well.

It inherits (prototypically) from
[ProtoList](https://github.com/isaacs/proto-list/), and also inherits
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.env" id="apidoc.element.config-chain.env">
        function <span class="apidocSignatureSpan">config-chain.</span>env
        <span class="apidocSignatureSpan">(prefix, env)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">env = function (prefix, env) {
  env = env || process.env
  var obj = {}
  var l = prefix.length
  for(var k in env) {
    if(k.indexOf(prefix) === 0)
      obj[k.substring(l)] = env[k]
  }

  return obj
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.addString(data, file, type, marker)
}.bind(this))
return this
}

ConfigChain.prototype.addEnv = function (prefix, env, name) {
name = name || 'env'
var data = exports.<span class="apidocCodeKeywordSpan">env</span>(prefix, env)
this.sources[name] = { data: data, source: env, prefix: prefix }
return this.add(data, name)
}

ConfigChain.prototype.addUrl = function (req, type, name) {
this._await()
var href = url.format(req)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.find" id="apidoc.element.config-chain.find">
        function <span class="apidocSignatureSpan">config-chain.</span>find
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">find = function () {
  var rel = path.join.apply(null, [].slice.call(arguments))

  function find(start, rel) {
    var file = path.join(start, rel)
    try {
      fs.statSync(file)
      return file
    } catch (err) {
      if(path.dirname(start) !== start) // root
        return find(path.dirname(start), rel)
    }
  }
  return find(__dirname, rel)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  ? path.join(__dirname, 'special.json') //load a special file
  : null //NULL IS IGNORED!

//SUBDIR FOR ENV CONFIG
path.join(__dirname,  'config', env, 'config.json'),

//SEARCH PARENT DIRECTORIES FROM CURRENT DIR FOR FILE
cc.<span class="apidocCodeKeywordSpan">find</span>('config.json'),

//PUT DEFAULTS LAST
{
  host: 'localhost'
  port: 8000
})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.json" id="apidoc.element.config-chain.json">
        function <span class="apidocSignatureSpan">config-chain.</span>json
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">json = function () {
  var args = [].slice.call(arguments).filter(function (arg) { return arg != null })
  var file = path.join.apply(null, args)
  var content
  try {
    content = fs.readFileSync(file,'utf-8')
  } catch (err) {
    return
  }
  return parse(content, file, 'json')
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

If the arg is a STRING, then it shall be a JSON FILENAME.

SYNC I/O!

RETURN THE CHAIN!

## cc.<span class="apidocCodeKeywordSpan">json</span>(...args)

Join the args INTO A JSON FILENAME!

SYNC I/O!

## cc.find(relativePath)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.parse" id="apidoc.element.config-chain.parse">
        function <span class="apidocSignatureSpan">config-chain.</span>parse
        <span class="apidocSignatureSpan">(content, file, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (content, file, type) {
  content = '' + content
  // if we don't know what it is, try json and fall back to ini
  // if we know what it is, then it must be that.
  if (!type) {
    try { return JSON.parse(content) }
    catch (er) { return ini.parse(content) }
  } else if (type === 'json') {
    if (this.emit) {
      try { return JSON.parse(content) }
      catch (er) { this.emit('error', er) }
    } else {
      return JSON.parse(content)
    }
  } else {
    return ini.parse(content)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

var parse = exports.parse = function (content, file, type) {
content = '' + content
// if we don't know what it is, try json and fall back to ini
// if we know what it is, then it must be that.
if (!type) {
  try { return JSON.<span class="apidocCodeKeywordSpan">parse</span>(content) }
  catch (er) { return ini.parse(content) }
} else if (type === 'json') {
  if (this.emit) {
    try { return JSON.parse(content) }
    catch (er) { this.emit('error', er) }
  } else {
    return JSON.parse(content)
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.config-chain.ConfigChain" id="apidoc.module.config-chain.ConfigChain">module config-chain.ConfigChain</a></h1>


    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.ConfigChain" id="apidoc.element.config-chain.ConfigChain.ConfigChain">
        function <span class="apidocSignatureSpan">config-chain.</span>ConfigChain
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ConfigChain() {
  EE.apply(this)
  ProtoList.apply(this, arguments)
  this._awaiting = 0
  this._saving = 0
  this.sources = {}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Get all the keys on the provided env object (or process.env) which are
prefixed by the specified prefix, and put the values on a new object.

RETURN THE RESULTING OBJECT!

NO I/O!

## cc.<span class="apidocCodeKeywordSpan">ConfigChain</span>()

The ConfigChain class for CRAY CRAY JQUERY STYLE METHOD CHAINING!

One of these is returned by the main exported function, as well.

It inherits (prototypically) from
[ProtoList](https://github.com/isaacs/proto-list/), and also inherits
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.config-chain.ConfigChain.prototype" id="apidoc.module.config-chain.ConfigChain.prototype">module config-chain.ConfigChain.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype._await" id="apidoc.element.config-chain.ConfigChain.prototype._await">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>_await
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_await = function () {
  this._awaiting++
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

ConfigChain.prototype.addFile = function (file, type, name) {
  name = name || file
  var marker = {__source__:name}
  this.sources[name] = { path: file, type: type }
  this.push(marker)
  this.<span class="apidocCodeKeywordSpan">_await</span>()
  fs.readFile(file, 'utf8', function (er, data) {
    if (er) this.emit('error', er)
    this.addString(data, file, type, marker)
  }.bind(this))
  return this
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype._resolve" id="apidoc.element.config-chain.ConfigChain.prototype._resolve">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>_resolve
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_resolve = function () {
  this._awaiting--
  if (this._awaiting === 0) this.emit('load', this)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return this.emit('error', new Error('bad marker'))
  }
  this.splice(i, 1, data)
  marker = marker.__source__
  this.sources[marker] = this.sources[marker] || {}
  this.sources[marker].data = data
  // we were waiting for this.  maybe emit 'load'
  this.<span class="apidocCodeKeywordSpan">_resolve</span>()
} else {
  if (typeof marker === 'string') {
    this.sources[marker] = this.sources[marker] || {}
    this.sources[marker].data = data
  }
  // trigger the load event if nothing was already going to do so.
  this._await()
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.add" id="apidoc.element.config-chain.ConfigChain.prototype.add">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>add
        <span class="apidocSignatureSpan">(data, marker)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (data, marker) {
  if (marker &amp;&amp; typeof marker === 'object') {
    var i = this.list.indexOf(marker)
    if (i === -1) {
      return this.emit('error', new Error('bad marker'))
    }
    this.splice(i, 1, data)
    marker = marker.__source__
    this.sources[marker] = this.sources[marker] || {}
    this.sources[marker].data = data
    // we were waiting for this.  maybe emit 'load'
    this._resolve()
  } else {
    if (typeof marker === 'string') {
      this.sources[marker] = this.sources[marker] || {}
      this.sources[marker].data = data
    }
    // trigger the load event if nothing was already going to do so.
    this._await()
    this.push(data)
    process.nextTick(this._resolve.bind(this))
  }
  return this
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
return this
}

ConfigChain.prototype.addEnv = function (prefix, env, name) {
name = name || 'env'
var data = exports.env(prefix, env)
this.sources[name] = { data: data, source: env, prefix: prefix }
return this.<span class="apidocCodeKeywordSpan">add</span>(data, name)
}

ConfigChain.prototype.addUrl = function (req, type, name) {
this._await()
var href = url.format(req)
name = name || href
var marker = {__source__:name}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.addEnv" id="apidoc.element.config-chain.ConfigChain.prototype.addEnv">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addEnv
        <span class="apidocSignatureSpan">(prefix, env, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addEnv = function (prefix, env, name) {
  name = name || 'env'
  var data = exports.env(prefix, env)
  this.sources[name] = { data: data, source: env, prefix: prefix }
  return this.add(data, name)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

## chain.addUrl(url, type, [name=url])

Same as the filename thing, but with a url.

Can't be saved later.

## chain.<span class="apidocCodeKeywordSpan">addEnv</span>(prefix, env, [name='env'])

Add all the keys from the env object that start with the prefix.

## chain.addString(data, file, type, [name])

Parse the string and add it to the set.  (Mainly used internally.)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.addFile" id="apidoc.element.config-chain.ConfigChain.prototype.addFile">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addFile
        <span class="apidocSignatureSpan">(file, type, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFile = function (file, type, name) {
  name = name || file
  var marker = {__source__:name}
  this.sources[name] = { path: file, type: type }
  this.push(marker)
  this._await()
  fs.readFile(file, 'utf8', function (er, data) {
    if (er) this.emit('error', er)
    this.addString(data, file, type, marker)
  }.bind(this))
  return this
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  },
  cc.find('config.json'),
  cc.env('myApp_')
)
// CONFIGS AS A SERVICE, aka "CaaS", aka EVERY DEVOPS DREAM OMG!
.addUrl('http://configurator:1234/my-configs')
// ASYNC FTW!
.<span class="apidocCodeKeywordSpan">addFile</span>('/path/to/file.json')

// OBJECTS ARE OK TOO, they're SYNC but they still ORDER RIGHT
// BECAUSE PROMISES ARE USED BUT NO, NOT *THOSE* PROMISES, JUST
// ACTUAL PROMISES LIKE YOU MAKE TO YOUR MOM, KEPT OUT OF LOVE
.add({ another: 'object' })

// DIE A THOUSAND DEATHS IF THIS EVER HAPPENS!!
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.addListener" id="apidoc.element.config-chain.ConfigChain.prototype.addListener">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addListener
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function addListener(type, listener) {
  return _addListener(this, type, listener, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.addString" id="apidoc.element.config-chain.ConfigChain.prototype.addString">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addString
        <span class="apidocSignatureSpan">(data, file, type, marker)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addString = function (data, file, type, marker) {
  data = this.parse(data, file, type)
  this.add(data, marker)
  return this
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
name = name || file
var marker = {__source__:name}
this.sources[name] = { path: file, type: type }
this.push(marker)
this._await()
fs.readFile(file, 'utf8', function (er, data) {
  if (er) this.emit('error', er)
  this.<span class="apidocCodeKeywordSpan">addString</span>(data, file, type, marker)
}.bind(this))
return this
}

ConfigChain.prototype.addEnv = function (prefix, env, name) {
name = name || 'env'
var data = exports.env(prefix, env)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.addUrl" id="apidoc.element.config-chain.ConfigChain.prototype.addUrl">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>addUrl
        <span class="apidocSignatureSpan">(req, type, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addUrl = function (req, type, name) {
  this._await()
  var href = url.format(req)
  name = name || href
  var marker = {__source__:name}
  this.sources[name] = { href: href, type: type }
  this.push(marker)
  http.request(req, function (res) {
    var c = []
    var ct = res.headers['content-type']
    if (!type) {
      type = ct.indexOf('json') !== -1 ? 'json'
           : ct.indexOf('ini') !== -1 ? 'ini'
           : href.match(/\.json$/) ? 'json'
           : href.match(/\.ini$/) ? 'ini'
           : null
      marker.type = type
    }

    res.on('data', c.push.bind(c))
    .on('end', function () {
      this.addString(Buffer.concat(c), href, type, marker)
    }.bind(this))
    .on('error', this.emit.bind(this, 'error'))

  }.bind(this))
  .on('error', this.emit.bind(this, 'error'))
  .end()

  return this
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var config = cc({
    some: 'object'
  },
  cc.find('config.json'),
  cc.env('myApp_')
)
// CONFIGS AS A SERVICE, aka "CaaS", aka EVERY DEVOPS DREAM OMG!
.<span class="apidocCodeKeywordSpan">addUrl</span>('http://configurator:1234/my-configs')
// ASYNC FTW!
.addFile('/path/to/file.json')

// OBJECTS ARE OK TOO, they're SYNC but they still ORDER RIGHT
// BECAUSE PROMISES ARE USED BUT NO, NOT *THOSE* PROMISES, JUST
// ACTUAL PROMISES LIKE YOU MAKE TO YOUR MOM, KEPT OUT OF LOVE
.add({ another: 'object' })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.del" id="apidoc.element.config-chain.ConfigChain.prototype.del">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>del
        <span class="apidocSignatureSpan">(key, where)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">del = function (key, where) {
  // if not specified where, then delete from the whole chain, scorched
  // earth style
  if (where) {
    var target = this.sources[where]
    target = target &amp;&amp; target.data
    if (!target) {
      return this.emit('error', new Error('not found '+where))
    }
    delete target[key]
  } else {
    for (var i = 0, l = this.list.length; i &lt; l; i ++) {
      delete this.list[i][key]
    }
  }
  return this
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.emit" id="apidoc.element.config-chain.ConfigChain.prototype.emit">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>emit
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function emit(type) {
  var er, handler, len, args, i, events, domain;
  var needDomainExit = false;
  var doError = (type === 'error');

  events = this._events;
  if (events)
    doError = (doError &amp;&amp; events.error == null);
  else if (!doError)
    return false;

  domain = this.domain;

  // If there is no 'error' event listener then throw.
  if (doError) {
    er = arguments[1];
    if (domain) {
      if (!er)
        er = new Error('Uncaught, unspecified "error" event');
      er.domainEmitter = this;
      er.domain = domain;
      er.domainThrown = false;
      domain.emit('error', er);
    } else if (er instanceof Error) {
      throw er; // Unhandled 'error' event
    } else {
      // At least give some kind of context to the user
      var err = new Error('Uncaught, unspecified "error" event. (' + er + ')');
      err.context = er;
      throw err;
    }
    return false;
  }

  handler = events[type];

  if (!handler)
    return false;

  if (domain &amp;&amp; this !== process) {
    domain.enter();
    needDomainExit = true;
  }

  var isFn = typeof handler === 'function';
  len = arguments.length;
  switch (len) {
    // fast cases
    case 1:
      emitNone(handler, isFn, this);
      break;
    case 2:
      emitOne(handler, isFn, this, arguments[1]);
      break;
    case 3:
      emitTwo(handler, isFn, this, arguments[1], arguments[2]);
      break;
    case 4:
      emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);
      break;
    // slower
    default:
      args = new Array(len - 1);
      for (i = 1; i &lt; len; i++)
        args[i - 1] = arguments[i];
      emitMany(handler, isFn, this, args);
  }

  if (needDomainExit)
    domain.exit();

  return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // if we know what it is, then it must be that.
  if (!type) {
    try { return JSON.parse(content) }
    catch (er) { return ini.parse(content) }
  } else if (type === 'json') {
    if (this.emit) {
      try { return JSON.parse(content) }
      catch (er) { this.<span class="apidocCodeKeywordSpan">emit</span>('error', er) }
    } else {
      return JSON.parse(content)
    }
  } else {
    return ini.parse(content)
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.eventNames" id="apidoc.element.config-chain.ConfigChain.prototype.eventNames">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>eventNames
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function eventNames() {
  return this._eventsCount &gt; 0 ? Reflect.ownKeys(this._events) : [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.get" id="apidoc.element.config-chain.ConfigChain.prototype.get">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>get
        <span class="apidocSignatureSpan">(key, where)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (key, where) {
  if (where) {
    where = this.sources[where]
    if (where) where = where.data
    if (where &amp;&amp; Object.hasOwnProperty.call(where, key)) return where[key]
    return undefined
  }
  return this.list[0][key]
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

    //PUT DEFAULTS LAST
    {
      host: 'localhost'
      port: 8000
    })

  var host = conf.<span class="apidocCodeKeywordSpan">get</span>('host')

  // or

  var host = conf.store.host

```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.getMaxListeners" id="apidoc.element.config-chain.ConfigChain.prototype.getMaxListeners">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>getMaxListeners
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getMaxListeners() {
  return $getMaxListeners(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.listenerCount" id="apidoc.element.config-chain.ConfigChain.prototype.listenerCount">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>listenerCount
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function listenerCount(type) {
  const events = this._events;

  if (events) {
    const evlistener = events[type];

    if (typeof evlistener === 'function') {
      return 1;
    } else if (evlistener) {
      return evlistener.length;
    }
  }

  return 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.listeners" id="apidoc.element.config-chain.ConfigChain.prototype.listeners">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>listeners
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function listeners(type) {
  var evlistener;
  var ret;
  var events = this._events;

  if (!events)
    ret = [];
  else {
    evlistener = events[type];
    if (!evlistener)
      ret = [];
    else if (typeof evlistener === 'function')
      ret = [evlistener];
    else
      ret = arrayClone(evlistener, evlistener.length);
  }

  return ret;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.on" id="apidoc.element.config-chain.ConfigChain.prototype.on">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>on
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function addListener(type, listener) {
  return _addListener(this, type, listener, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
         : ct.indexOf('ini') !== -1 ? 'ini'
         : href.match(/\.json$/) ? 'json'
         : href.match(/\.ini$/) ? 'ini'
         : null
    marker.type = type
  }

  res.<span class="apidocCodeKeywordSpan">on</span>('data', c.push.bind(c))
  .on('end', function () {
    this.addString(Buffer.concat(c), href, type, marker)
  }.bind(this))
  .on('error', this.emit.bind(this, 'error'))

}.bind(this))
.on('error', this.emit.bind(this, 'error'))
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.once" id="apidoc.element.config-chain.ConfigChain.prototype.once">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>once
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function once(type, listener) {
  if (typeof listener !== 'function')
    throw new TypeError('"listener" argument must be a function');
  this.on(type, _onceWrap(this, type, listener));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.parse" id="apidoc.element.config-chain.ConfigChain.prototype.parse">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>parse
        <span class="apidocSignatureSpan">(content, file, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (content, file, type) {
  content = '' + content
  // if we don't know what it is, try json and fall back to ini
  // if we know what it is, then it must be that.
  if (!type) {
    try { return JSON.parse(content) }
    catch (er) { return ini.parse(content) }
  } else if (type === 'json') {
    if (this.emit) {
      try { return JSON.parse(content) }
      catch (er) { this.emit('error', er) }
    } else {
      return JSON.parse(content)
    }
  } else {
    return ini.parse(content)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

var parse = exports.parse = function (content, file, type) {
content = '' + content
// if we don't know what it is, try json and fall back to ini
// if we know what it is, then it must be that.
if (!type) {
  try { return JSON.<span class="apidocCodeKeywordSpan">parse</span>(content) }
  catch (er) { return ini.parse(content) }
} else if (type === 'json') {
  if (this.emit) {
    try { return JSON.parse(content) }
    catch (er) { this.emit('error', er) }
  } else {
    return JSON.parse(content)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.prependListener" id="apidoc.element.config-chain.ConfigChain.prototype.prependListener">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>prependListener
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function prependListener(type, listener) {
  return _addListener(this, type, listener, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.prependOnceListener" id="apidoc.element.config-chain.ConfigChain.prototype.prependOnceListener">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>prependOnceListener
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function prependOnceListener(type, listener) {
  if (typeof listener !== 'function')
    throw new TypeError('"listener" argument must be a function');
  this.prependListener(type, _onceWrap(this, type, listener));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.removeAllListeners" id="apidoc.element.config-chain.ConfigChain.prototype.removeAllListeners">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>removeAllListeners
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeAllListeners(type) {
  var listeners, events;

  events = this._events;
  if (!events)
    return this;

  // not listening for removeListener, no need to emit
  if (!events.removeListener) {
    if (arguments.length === 0) {
      this._events = new EventHandlers();
      this._eventsCount = 0;
    } else if (events[type]) {
      if (--this._eventsCount === 0)
        this._events = new EventHandlers();
      else
        delete events[type];
    }
    return this;
  }

  // emit removeListener for all listeners on all events
  if (arguments.length === 0) {
    var keys = Object.keys(events);
    for (var i = 0, key; i &lt; keys.length; ++i) {
      key = keys[i];
      if (key === 'removeListener') continue;
      this.removeAllListeners(key);
    }
    this.removeAllListeners('removeListener');
    this._events = new EventHandlers();
    this._eventsCount = 0;
    return this;
  }

  listeners = events[type];

  if (typeof listeners === 'function') {
    this.removeListener(type, listeners);
  } else if (listeners) {
    // LIFO order
    do {
      this.removeListener(type, listeners[listeners.length - 1]);
    } while (listeners[0]);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.removeListener" id="apidoc.element.config-chain.ConfigChain.prototype.removeListener">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>removeListener
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeListener(type, listener) {
  var list, events, position, i, originalListener;

  if (typeof listener !== 'function')
    throw new TypeError('"listener" argument must be a function');

  events = this._events;
  if (!events)
    return this;

  list = events[type];
  if (!list)
    return this;

  if (list === listener || list.listener === listener) {
    if (--this._eventsCount === 0)
      this._events = new EventHandlers();
    else {
      delete events[type];
      if (events.removeListener)
        this.emit('removeListener', type, list.listener || listener);
    }
  } else if (typeof list !== 'function') {
    position = -1;

    for (i = list.length; i-- &gt; 0;) {
      if (list[i] === listener || list[i].listener === listener) {
        originalListener = list[i].listener;
        position = i;
        break;
      }
    }

    if (position &lt; 0)
      return this;

    if (list.length === 1) {
      list[0] = undefined;
      if (--this._eventsCount === 0) {
        this._events = new EventHandlers();
        return this;
      } else {
        delete events[type];
      }
    } else {
      spliceOne(list, position);
    }

    if (events.removeListener)
      this.emit('removeListener', type, originalListener || listener);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.save" id="apidoc.element.config-chain.ConfigChain.prototype.save">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>save
        <span class="apidocSignatureSpan">(where, type, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">save = function (where, type, cb) {
  if (typeof type === 'function') cb = type, type = null
  var target = this.sources[where]
  if (!target || !(target.path || target.source) || !target.data) {
    // TODO: maybe save() to a url target could be a PUT or something?
    // would be easy to swap out with a reddis type thing, too
    return this.emit('error', new Error('bad save target: '+where))
  }

  if (target.source) {
    var pref = target.prefix || ''
    Object.keys(target.data).forEach(function (k) {
      target.source[pref + k] = target.data[k]
    })
    return this
  }

  var type = type || target.type
  var data = target.data
  if (target.type === 'json') {
    data = JSON.stringify(data)
  } else {
    data = ini.stringify(data)
  }

  this._saving ++
  fs.writeFile(target.path, data, 'utf8', function (er) {
    this._saving --
    if (er) {
      if (cb) return cb(er)
      else return this.emit('error', er)
    }
    if (this._saving === 0) {
      if (cb) cb()
      this.emit('save')
    }
  }.bind(this))
  return this
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
the one with the highest priority, which was added first.)

## chain.get(key, [name])

Get the key from the named config object explicitly, or from the
resolved configs if not specified.

## chain.<span class="apidocCodeKeywordSpan">save</span>(name, type)

Write the named config object back to its origin.

Currently only supported for env and file config types.

For files, encode the data according to the type.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.set" id="apidoc.element.config-chain.ConfigChain.prototype.set">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>set
        <span class="apidocSignatureSpan">(key, value, where)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (key, value, where) {
  var target

  if (where) {
    target = this.sources[where]
    target = target &amp;&amp; target.data
    if (!target) {
      return this.emit('error', new Error('not found '+where))
    }
  } else {
    target = this.list[0]
    if (!target) {
      return this.emit('error', new Error('cannot set, no confs!'))
    }
  }
  target[key] = value
  return this
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
## chain.root {Object}

The root from which all the other config objects in the set descend
prototypically.

Put your defaults here.

## chain.<span class="apidocCodeKeywordSpan">set</span>(key, value, name)

Set the key to the value on the named config object.  If name is
unset, then set it on the first config object in the set.  (That is,
the one with the highest priority, which was added first.)

## chain.get(key, [name])
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.config-chain.ConfigChain.prototype.setMaxListeners" id="apidoc.element.config-chain.ConfigChain.prototype.setMaxListeners">
        function <span class="apidocSignatureSpan">config-chain.ConfigChain.prototype.</span>setMaxListeners
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function setMaxListeners(n) {
  if (typeof n !== 'number' || n &lt; 0 || isNaN(n))
    throw new TypeError('"n" argument must be a positive number');
  this._maxListeners = n;
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>